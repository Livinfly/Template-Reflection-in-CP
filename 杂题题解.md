## [B2. Range Sorting (Hard Version)](https://codeforces.com/contest/1827/problem/B2)

[cf - liuzhaoxu](https://www.cnblogs.com/Lour688/p/17403276.html#1827b2-range-sortinghard-version-link)

有种用两个单调栈总共 $O(n)$ 算出 $x$ 的做法，但不是很懂。

## [WC2011 最大XOR和路径](https://www.luogu.com.cn/problem/P4151)

线性基。

链和若干环的最大异或和。

## [CQOI2013 新Nim游戏](https://www.luogu.com.cn/problem/P4301)

线性基。

先手必胜就是后手无论怎么拿都无法构造出异或和为 0。

## [Goodbye Souvenir](https://www.luogu.com.cn/problem/CF848C)

cdq分治求解动态修改二维偏序问题。

先不考虑修改，答案就是，点 `(pre_i, i)` 按照 `l` 或者 `r` ，再在另一个维上维护满足条件的值的和。

需要满足的条件为 `pre_i >= l` 和 `i <= r`。

修改的话，我们可以加一维时间维，然后用cdq分治算左区间的修改对右区间查询的贡献。

时间，l/r, l/r（修改/查询）。

操作只是附带的条件。

注意，查询的贡献可能由多部分组成，需要累加；`l` 和 `r` 在cdq分治的操作数组里有不同含义。

用 `set` 数组维护相同颜色的前一个，同时把修改改成多个在`set`上的操作。

## [天使玩偶/SJY摆棋子](https://www.luogu.com.cn/problem/P4169)

cdq分治。

时间，x，y（修改/查询），三元组。

去绝对值查`x+y - (x, y)`，查四次。

## [POI2015 KIN](https://www.luogu.com.cn/problem/P3582)

二维偏序。

从前往后枚举`r`，然后维护所有`[i, r]`的结果的最大值，新加进来一个数，在这个数到它前一次出现的位置`pre[i]`后一个位置加`w`；

若还存在`pre[pre[i]]`则把这一段减去`w`；

再前面已经清空，就不用管了。区间加法、区间求最大值。

## [防线 Defense Lines](https://www.luogu.com.cn/problem/UVA1471)

主要要考虑到最终答案序列是由前后两端组成的，之后就可以从前往后，先考虑后面一段，看有没有符合的前面一段，有就取最大值，或者从后往前。

